<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>vkTUNEos Killer Dashboard</title>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-base: #0a0a0f;
      --bg-surface: #12121a;
      --bg-card: #1a1a24;
      --bg-elevated: #22222e;
      --border-subtle: rgba(255,255,255,0.06);
      --border-default: rgba(255,255,255,0.1);
      --text-primary: #f4f4f5;
      --text-secondary: #a0a0b0;
      --text-muted: #64648a;
      --primary-400: #22d3ee;
      --primary-500: #06b6d4;
      --primary-600: #0891b2;
      --accent-400: #f472b6;
      --accent-500: #ec4899;
      --accent-600: #db2777;
      --success-500: #22c55e;
      --warning-500: #eab308;
      --error-500: #ef4444;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Inter', sans-serif; background: var(--bg-base); color: var(--text-primary); min-height: 100vh; }
    .font-display { font-family: 'Space Grotesk', sans-serif; }
    ::-webkit-scrollbar { width: 8px; height: 8px; }
    ::-webkit-scrollbar-track { background: var(--bg-surface); }
    ::-webkit-scrollbar-thumb { background: var(--bg-elevated); border-radius: 4px; }
    ::-webkit-scrollbar-thumb:hover { background: var(--border-default); }
    input[type="range"] { -webkit-appearance: none; }
    input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; width: 16px; height: 16px; border-radius: 50%; background: white; cursor: pointer; box-shadow: 0 2px 6px rgba(0,0,0,0.3); }
    @keyframes spin { to { transform: rotate(360deg); } }
    .animate-spin { animation: spin 1s linear infinite; }
    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
    .animate-pulse { animation: pulse 2s ease-in-out infinite; }
    @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
    .toast-enter { animation: slideIn 0.3s ease-out; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    .fade-in { animation: fadeIn 0.2s ease-out; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect, createContext, useContext, useCallback } = React;

    // ========== TOAST SYSTEM ==========
    const ToastContext = createContext();
    const useToast = () => useContext(ToastContext);

    const ToastProvider = ({ children }) => {
      const [toasts, setToasts] = useState([]);
      const addToast = useCallback((message, type = 'info', duration = 3000) => {
        const id = Date.now();
        setToasts(prev => [...prev, { id, message, type }]);
        setTimeout(() => setToasts(prev => prev.filter(t => t.id !== id)), duration);
      }, []);
      return (
        <ToastContext.Provider value={{ addToast }}>
          {children}
          <div className="fixed top-4 right-4 z-[200] space-y-2">
            {toasts.map(t => (
              <div key={t.id} className="toast-enter px-4 py-3 rounded-xl shadow-lg flex items-center gap-3 min-w-[280px]"
                style={{ background: t.type === 'success' ? 'rgba(34,197,94,0.9)' : t.type === 'error' ? 'rgba(239,68,68,0.9)' : 'rgba(6,182,212,0.9)', color: 'white' }}>
                {t.type === 'success' && <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M20 6 9 17l-5-5"/></svg>}
                {t.type === 'error' && <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><path d="m15 9-6 6M9 9l6 6"/></svg>}
                {t.type === 'info' && <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4M12 8h.01"/></svg>}
                <span className="text-sm font-medium">{t.message}</span>
              </div>
            ))}
          </div>
        </ToastContext.Provider>
      );
    };

    // ========== STORE ==========
    const useStore = () => {
      const [state, setState] = useState(() => {
        const saved = localStorage.getItem('vktuneos-store');
        return saved ? JSON.parse(saved) : { page: 'dashboard', user: { name: 'Demo User', email: 'demo@vktuneos.com', avatar: null }, theme: 'dark', sidebarOpen: true };
      });
      const setPage = (page) => setState(prev => { const n = { ...prev, page }; localStorage.setItem('vktuneos-store', JSON.stringify(n)); return n; });
      const setUser = (user) => setState(prev => { const n = { ...prev, user }; localStorage.setItem('vktuneos-store', JSON.stringify(n)); return n; });
      const toggleSidebar = () => setState(prev => { const n = { ...prev, sidebarOpen: !prev.sidebarOpen }; localStorage.setItem('vktuneos-store', JSON.stringify(n)); return n; });
      return { ...state, setPage, setUser, toggleSidebar };
    };

    // ========== API CLIENT ==========
    const createAPI = (baseURL = '/api/v1') => ({
      get: async (path) => { await new Promise(r => setTimeout(r, 500)); return { data: {} }; },
      post: async (path, data) => { await new Promise(r => setTimeout(r, 500)); return { data: { id: Date.now(), ...data } }; },
      put: async (path, data) => { await new Promise(r => setTimeout(r, 500)); return { data }; },
      delete: async (path) => { await new Promise(r => setTimeout(r, 500)); return { success: true }; }
    });

    // ========== ICON COMPONENT ==========
    const Icon = ({ name, size = 20, className = '' }) => {
      const icons = {
        dashboard: <><rect width="7" height="9" x="3" y="3" rx="1"/><rect width="7" height="5" x="14" y="3" rx="1"/><rect width="7" height="9" x="14" y="12" rx="1"/><rect width="7" height="5" x="3" y="16" rx="1"/></>,
        music: <><path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/></>,
        mic: <><path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/><line x1="12" y1="19" x2="12" y2="22"/></>,
        video: <><path d="m22 8-6 4 6 4V8Z"/><rect width="14" height="12" x="2" y="6" rx="2" ry="2"/></>,
        grid: <><rect width="7" height="7" x="3" y="3" rx="1"/><rect width="7" height="7" x="14" y="3" rx="1"/><rect width="7" height="7" x="14" y="14" rx="1"/><rect width="7" height="7" x="3" y="14" rx="1"/></>,
        workflow: <><rect width="8" height="4" x="3" y="3" rx="1"/><path d="M7 7v3a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V7"/><rect width="8" height="4" x="13" y="15" rx="1"/><path d="M17 15v-3a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v3"/></>,
        users: <><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></>,
        audit: <><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></>,
        sparkles: <><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/></>,
        menu: <><line x1="4" y1="12" x2="20" y2="12"/><line x1="4" y1="6" x2="20" y2="6"/><line x1="4" y1="18" x2="20" y2="18"/></>,
        search: <><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></>,
        bell: <><path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"/><path d="M10.3 21a1.94 1.94 0 0 0 3.4 0"/></>,
        settings: <><circle cx="12" cy="12" r="3"/><path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/></>,
        chevronDown: <><polyline points="6 9 12 15 18 9"/></>,
        play: <><polygon points="5 3 19 12 5 21 5 3"/></>,
        plus: <><path d="M5 12h14M12 5v14"/></>
      };
      return <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>{icons[name] || icons.dashboard}</svg>;
    };

    // ========== SIDEBAR ==========
    const Sidebar = ({ store }) => {
      const navItems = [
        { id: 'dashboard', label: 'Dashboard', icon: 'dashboard' },
        { id: 'music', label: 'Music Studio', icon: 'music' },
        { id: 'voice', label: 'Voice Lab', icon: 'mic' },
        { id: 'video', label: 'Video Studio', icon: 'video' },
        { id: 'coordinates', label: 'Coordinates', icon: 'grid' },
        { id: 'workflows', label: 'Workflows', icon: 'workflow' },
        { id: 'tenants', label: 'Tenants', icon: 'users' },
        { id: 'audit', label: 'Audit Log', icon: 'audit' },
        { id: 'killer', label: 'Killer Features', icon: 'sparkles' }
      ];
      return (
        <aside className={`fixed left-0 top-0 h-full z-40 transition-all duration-300 ${store.sidebarOpen ? 'w-64' : 'w-20'}`} style={{ background: 'var(--bg-surface)', borderRight: '1px solid var(--border-subtle)' }}>
          <div className="flex items-center gap-3 p-5 h-16" style={{ borderBottom: '1px solid var(--border-subtle)' }}>
            <div className="w-10 h-10 rounded-xl flex items-center justify-center" style={{ background: 'linear-gradient(135deg, var(--primary-500), var(--accent-500))' }}>
              <span className="text-white font-bold text-lg">V</span>
            </div>
            {store.sidebarOpen && <span className="font-display font-bold text-lg">vkTUNEos</span>}
          </div>
          <nav className="p-3 space-y-1">
            {navItems.map(item => (
              <button key={item.id} onClick={() => store.setPage(item.id)}
                className={`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all ${store.page === item.id ? 'text-white' : ''}`}
                style={{ background: store.page === item.id ? 'linear-gradient(135deg, var(--primary-500), var(--accent-500))' : 'transparent', color: store.page === item.id ? 'white' : 'var(--text-secondary)' }}>
                <Icon name={item.icon} size={20} />
                {store.sidebarOpen && <span className="text-sm font-medium">{item.label}</span>}
              </button>
            ))}
          </nav>
        </aside>
      );
    };

    // ========== HEADER ==========
    const Header = ({ store }) => {
      const toast = useToast();
      return (
        <header className="fixed top-0 right-0 h-16 z-30 flex items-center justify-between px-6" style={{ left: store.sidebarOpen ? '256px' : '80px', background: 'var(--bg-surface)', borderBottom: '1px solid var(--border-subtle)', transition: 'left 0.3s' }}>
          <div className="flex items-center gap-4">
            <button onClick={store.toggleSidebar} className="p-2 rounded-lg transition-colors" style={{ color: 'var(--text-secondary)' }}><Icon name="menu" size={20} /></button>
            <div className="relative hidden sm:block">
              <Icon name="search" size={18} className="absolute left-3 top-1/2 -translate-y-1/2" style={{ color: 'var(--text-muted)' }} />
              <input type="text" placeholder="Search..." className="w-64 pl-10 pr-4 py-2 rounded-xl text-sm outline-none" style={{ background: 'var(--bg-card)', border: '1px solid var(--border-subtle)', color: 'var(--text-primary)' }} />
            </div>
          </div>
          <div className="flex items-center gap-3">
            <button onClick={() => toast.addToast('No new notifications', 'info')} className="p-2 rounded-lg relative" style={{ color: 'var(--text-secondary)' }}>
              <Icon name="bell" size={20} />
              <span className="absolute top-1 right-1 w-2 h-2 rounded-full" style={{ background: 'var(--accent-500)' }} />
            </button>
            <div className="w-9 h-9 rounded-full flex items-center justify-center cursor-pointer" style={{ background: 'linear-gradient(135deg, var(--primary-500), var(--accent-500))' }}>
              <span className="text-white text-sm font-semibold">{store.user?.name?.[0] || 'U'}</span>
            </div>
          </div>
        </header>
      );
    };

    // ========== TREEVIEW FOR COORDINATES ==========
    const TreeView = ({ data, selectedId, onSelect }) => {
      const [expanded, setExpanded] = useState(new Set(['cat-1', 'cat-2']));
      const toggleExpand = (id) => { const n = new Set(expanded); n.has(id) ? n.delete(id) : n.add(id); setExpanded(n); };
      const renderNode = (node, level = 0) => {
        const hasChildren = node.children?.length > 0;
        const isExpanded = expanded.has(node.id);
        const isSelected = selectedId === node.id;
        return (
          <div key={node.id}>
            <div className="flex items-center gap-2 px-2 py-1.5 rounded-lg cursor-pointer transition-all" onClick={() => onSelect(node)}
              style={{ marginLeft: `${level * 12}px`, background: isSelected ? 'linear-gradient(135deg, rgba(6,182,212,0.15), rgba(236,72,153,0.1))' : 'transparent', borderLeft: isSelected ? '2px solid var(--primary-500)' : '2px solid transparent' }}>
              {hasChildren ? (
                <button onClick={(e) => { e.stopPropagation(); toggleExpand(node.id); }} className="p-0.5">
                  <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" style={{ color: 'var(--text-muted)', transform: isExpanded ? 'rotate(90deg)' : '', transition: 'transform 0.2s' }}><polyline points="9 18 15 12 9 6"/></svg>
                </button>
              ) : <span className="w-5"/>}
              <span className="flex-1 text-sm truncate" style={{ color: isSelected ? 'var(--primary-400)' : 'var(--text-primary)' }}>{node.name}</span>
              {node.count !== undefined && <span className="text-xs px-1.5 py-0.5 rounded" style={{ background: 'var(--bg-elevated)', color: 'var(--text-muted)' }}>{node.count}</span>}
            </div>
            {hasChildren && isExpanded && <div>{node.children.map(c => renderNode(c, level + 1))}</div>}
          </div>
        );
      };
      return <div className="space-y-1">{data.map(n => renderNode(n))}</div>;
    };

    // ========== PAGE 1: DASHBOARD ==========
    const DashboardPage = ({ api, store }) => {
      const toast = useToast();
      const [stats, setStats] = useState(null);
      const [activity, setActivity] = useState([]);
      const [loading, setLoading] = useState(true);

      useEffect(() => { loadDashboardData(); }, []);

      const loadDashboardData = async () => {
        setLoading(true);
        setStats({ totalTracks: 1247, voiceModels: 23, workflows: 8, apiCalls: '45.2K', storageUsed: '12.4 GB', creditsRemaining: 8500 });
        setActivity([
          { id: 1, type: 'music', action: 'Generated track', title: 'Summer Vibes', time: '2 min ago', status: 'completed' },
          { id: 2, type: 'voice', action: 'Cloned voice', title: 'Sarah Voice Model', time: '15 min ago', status: 'completed' },
          { id: 3, type: 'video', action: 'Exported video', title: 'Music Video v2', time: '1 hour ago', status: 'completed' },
          { id: 4, type: 'workflow', action: 'Ran workflow', title: 'Auto-Master Pipeline', time: '2 hours ago', status: 'completed' },
          { id: 5, type: 'music', action: 'Generating track', title: 'Night Drive Beat', time: 'In progress', status: 'running' }
        ]);
        setLoading(false);
        toast.addToast('Dashboard loaded', 'success');
      };

      const statCards = [
        { label: 'Total Tracks', value: stats?.totalTracks || 0, icon: 'music', color: 'primary' },
        { label: 'Voice Models', value: stats?.voiceModels || 0, icon: 'mic', color: 'accent' },
        { label: 'Workflows', value: stats?.workflows || 0, icon: 'workflow', color: 'success' },
        { label: 'API Calls', value: stats?.apiCalls || 0, icon: 'activity', color: 'warning' }
      ];

      const quickActions = [
        { label: 'Generate Music', icon: 'music', page: 'music', gradient: 'linear-gradient(135deg, #06b6d4, #0891b2)' },
        { label: 'Clone Voice', icon: 'mic', page: 'voice', gradient: 'linear-gradient(135deg, #ec4899, #db2777)' },
        { label: 'Create Video', icon: 'video', page: 'video', gradient: 'linear-gradient(135deg, #8b5cf6, #7c3aed)' },
        { label: 'Run Workflow', icon: 'workflow', page: 'workflows', gradient: 'linear-gradient(135deg, #22c55e, #16a34a)' }
      ];

      return (
        <div className="fade-in">
          <div className="flex items-center justify-between mb-8">
            <div>
              <h1 className="text-2xl font-display font-bold" style={{ color: 'var(--text-primary)' }}>Dashboard</h1>
              <p className="text-sm mt-1" style={{ color: 'var(--text-secondary)' }}>Welcome back! Here's what's happening.</p>
            </div>
            <button onClick={loadDashboardData} className="flex items-center gap-2 px-4 py-2 rounded-xl text-sm transition-all" style={{ background: 'var(--bg-card)', color: 'var(--text-secondary)', border: '1px solid var(--border-subtle)' }}>
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={loading ? 'animate-spin' : ''}><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/></svg>
              Refresh
            </button>
          </div>
          <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
            {statCards.map((stat, i) => (
              <div key={i} className="p-5 rounded-xl transition-all hover:scale-[1.02]" style={{ background: 'var(--bg-card)', border: '1px solid var(--border-subtle)' }}>
                <div className="flex items-center justify-between">
                  <div>
                    <p className="text-sm mb-1" style={{ color: 'var(--text-secondary)' }}>{stat.label}</p>
                    {loading ? <div className="w-16 h-8 rounded animate-pulse" style={{ background: 'var(--bg-elevated)' }} /> : <p className="text-2xl font-display font-bold">{stat.value.toLocaleString?.() || stat.value}</p>}
                  </div>
                  <div className="w-12 h-12 rounded-xl flex items-center justify-center" style={{ background: 'linear-gradient(135deg, rgba(6,182,212,0.15), rgba(236,72,153,0.1))' }}>
                    <Icon name={stat.icon} size={20} />
                  </div>
                </div>
              </div>
            ))}
          </div>
          <h2 className="text-lg font-display font-semibold mb-4" style={{ color: 'var(--text-primary)' }}>Quick Actions</h2>
          <div className="grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
            {quickActions.map((action, i) => (
              <button key={i} onClick={() => store.setPage(action.page)} className="p-5 rounded-xl text-left transition-all hover:scale-[1.02]" style={{ background: action.gradient }}>
                <div className="w-10 h-10 rounded-lg flex items-center justify-center mb-3" style={{ background: 'rgba(255,255,255,0.2)' }}><Icon name={action.icon} size={20} /></div>
                <p className="font-semibold text-white">{action.label}</p>
              </button>
            ))}
          </div>
          <h2 className="text-lg font-display font-semibold mb-4" style={{ color: 'var(--text-primary)' }}>Recent Activity</h2>
          <div className="rounded-xl overflow-hidden" style={{ background: 'var(--bg-card)', border: '1px solid var(--border-subtle)' }}>
            {activity.map((item, i) => (
              <div key={item.id} className="flex items-center gap-4 p-4 transition-colors" style={{ borderBottom: i < activity.length - 1 ? '1px solid var(--border-subtle)' : 'none' }}
                onMouseOver={(e) => e.currentTarget.style.background = 'var(--bg-elevated)'} onMouseOut={(e) => e.currentTarget.style.background = 'transparent'}>
                <div className="w-10 h-10 rounded-lg flex items-center justify-center" style={{ background: 'var(--bg-elevated)', color: 'var(--primary-400)' }}><Icon name={item.type} size={16} /></div>
                <div className="flex-1 min-w-0">
                  <p className="text-sm font-medium truncate" style={{ color: 'var(--text-primary)' }}>{item.action}: <span style={{ color: 'var(--primary-400)' }}>{item.title}</span></p>
                  <p className="text-xs" style={{ color: 'var(--text-muted)' }}>{item.time}</p>
                </div>
                <span className="px-2.5 py-1 text-xs font-medium rounded-full" style={{ background: item.status === 'completed' ? 'rgba(34,197,94,0.15)' : 'rgba(6,182,212,0.15)', color: item.status === 'completed' ? 'var(--success-500)' : 'var(--primary-400)' }}>{item.status}</span>
              </div>
            ))}
          </div>
        </div>
      );
    };

    // ========== PAGE 2: MUSIC STUDIO ==========
    const MusicStudioPage = ({ api, store }) => {
      const toast = useToast();
      const [prompt, setPrompt] = useState('');
      const [duration, setDuration] = useState(30);
      const [tempo, setTempo] = useState(120);
      const [key, setKey] = useState({ value: 'C', label: 'C Major' });
      const [generating, setGenerating] = useState(false);
      const [generatedTrack, setGeneratedTrack] = useState(null);
      const [stems, setStems] = useState({ vocals: { volume: 100, muted: false }, drums: { volume: 100, muted: false }, bass: { volume: 100, muted: false }, melody: { volume: 100, muted: false }, other: { volume: 100, muted: false } });

      const keyOptions = [{ value: 'C', label: 'C Major' }, { value: 'Cm', label: 'C Minor' }, { value: 'D', label: 'D Major' }, { value: 'Dm', label: 'D Minor' }, { value: 'E', label: 'E Major' }, { value: 'Em', label: 'E Minor' }, { value: 'F', label: 'F Major' }, { value: 'G', label: 'G Major' }, { value: 'A', label: 'A Major' }, { value: 'Am', label: 'A Minor' }];
      const exportFormats = ['WAV', 'MP3', 'FLAC', 'Stems (ZIP)'];

      const handleGenerate = async () => {
        if (!prompt.trim()) return;
        setGenerating(true);
        await new Promise(r => setTimeout(r, 3000));
        setGeneratedTrack({ id: Date.now(), title: prompt.slice(0, 30), duration, tempo, key: key.label, createdAt: new Date().toISOString() });
        setGenerating(false);
        toast.addToast('Track generated successfully!', 'success');
      };

      const handleStemVolume = (stem, value) => setStems(prev => ({ ...prev, [stem]: { ...prev[stem], volume: value } }));
      const toggleStemMute = (stem) => setStems(prev => ({ ...prev, [stem]: { ...prev[stem], muted: !prev[stem].muted } }));

      return (
        <div className="fade-in">
          <div className="mb-8">
            <h1 className="text-2xl font-display font-bold" style={{ color: 'var(--text-primary)' }}>Music Studio</h1>
            <p className="text-sm mt-1" style={{ color: 'var(--text-secondary)' }}>Generate, edit, and export AI-powered music</p>
          </div>
          <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <div className="lg:col-span-2">
              <div className="rounded-xl p-6" style={{ background: 'var(--bg-card)', border: '1px solid var(--border-subtle)' }}>
                <h2 className="text-lg font-semibold mb-6" style={{ color: 'var(--text-primary)' }}>Generate Music</h2>
                <div className="mb-6">
                  <label className="block text-sm font-medium mb-2" style={{ color: 'var(--text-secondary)' }}>Prompt</label>
                  <textarea value={prompt} onChange={(e) => setPrompt(e.target.value)} placeholder="Describe the music you want to create..." rows={4} className="w-full px-4 py-3 rounded-xl text-sm outline-none resize-none" style={{ background: 'var(--bg-elevated)', border: '1px solid var(--border-subtle)', color: 'var(--text-primary)' }} />
                </div>
                <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                  <div>
                    <label className="block text-sm font-medium mb-2" style={{ color: 'var(--text-secondary)' }}>Duration: {duration}s</label>
                    <input type="range" min="15" max="180" value={duration} onChange={(e) => setDuration(Number(e.target.value))} className="w-full h-2 rounded-full cursor-pointer" style={{ background: `linear-gradient(to right, var(--primary-500) ${((duration - 15) / 165) * 100}%, var(--bg-elevated) ${((duration - 15) / 165) * 100}%)` }} />
                  </div>
                  <div>
                    <label className="block text-sm font-medium mb-2" style={{ color: 'var(--text-secondary)' }}>Tempo: {tempo} BPM</label>
                    <input type="range" min="60" max="200" value={tempo} onChange={(e) => setTempo(Number(e.target.value))} className="w-full h-2 rounded-full cursor-pointer" style={{ background: `linear-gradient(to right, var(--primary-500) ${((tempo - 60) / 140) * 100}%, var(--bg-elevated) ${((tempo - 60) / 140) * 100}%)` }} />
                  </div>
                  <div>
                    <label className="block text-sm font-medium mb-2" style={{ color: 'var(--text-secondary)' }}>Key</label>
                    <select value={key.value} onChange={(e) => setKey(keyOptions.find(k => k.value === e.target.value))} className="w-full px-4 py-2.5 rounded-xl text-sm outline-none cursor-pointer" style={{ background: 'var(--bg-elevated)', border: '1px solid var(--border-subtle)', color: 'var(--text-primary)' }}>
                      {keyOptions.map(k => <option key={k.value} value={k.value}>{k.label}</option>)}
                    </select>
                  </div>
                </div>
                <button onClick={handleGenerate} disabled={!prompt.trim() || generating} className="w-full py-3 rounded-xl font-semibold text-white transition-all disabled:opacity-50" style={{ background: 'linear-gradient(135deg, var(--primary-500), var(--accent-500))' }}>
                  {generating ? <span className="flex items-center justify-center gap-2"><div className="w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin" />Generating...</span> : <span className="flex items-center justify-center gap-2"><Icon name="sparkles" size={20} />Generate Music</span>}
                </button>
              </div>
              {generatedTrack && (
                <div className="mt-6 rounded-xl p-6" style={{ background: 'var(--bg-card)', border: '1px solid var(--border-subtle)' }}>
                  <h2 className="text-lg font-semibold mb-4" style={{ color: 'var(--text-primary)' }}>Generated Track</h2>
                  <div className="flex items-center gap-4 p-4 rounded-xl mb-4" style={{ background: 'var(--bg-elevated)' }}>
                    <div className="w-16 h-16 rounded-lg flex items-center justify-center" style={{ background: 'linear-gradient(135deg, var(--primary-500), var(--accent-500))' }}><Icon name="play" size={24} /></div>
                    <div className="flex-1">
                      <h3 className="font-semibold" style={{ color: 'var(--text-primary)' }}>{generatedTrack.title}</h3>
                      <p className="text-sm" style={{ color: 'var(--text-muted)' }}>{generatedTrack.duration}s • {generatedTrack.tempo} BPM • {generatedTrack.key}</p>
                    </div>
                  </div>
                  <div className="h-16 rounded-lg mb-4 flex items-center justify-center" style={{ background: 'var(--bg-elevated)' }}>
                    <div className="flex items-center gap-1">{Array.from({ length: 50 }, (_, i) => <div key={i} className="w-1 rounded-full" style={{ height: `${Math.random() * 40 + 10}px`, background: i < 25 ? 'linear-gradient(to top, var(--primary-500), var(--accent-500))' : 'rgba(255,255,255,0.2)' }} />)}</div>
                  </div>
                  <div className="flex gap-3">
                    {exportFormats.map(format => <button key={format} onClick={() => toast.addToast(`Exporting as ${format}...`, 'info')} className="px-4 py-2 rounded-lg text-sm font-medium transition-all" style={{ background: 'var(--bg-elevated)', color: 'var(--text-secondary)', border: '1px solid var(--border-subtle)' }}>{format}</button>)}
                  </div>
                </div>
              )}
            </div>
            <div className="rounded-xl p-6" style={{ background: 'var(--bg-card)', border: '1px solid var(--border-subtle)' }}>
              <h2 className="text-lg font-semibold mb-6" style={{ color: 'var(--text-primary)' }}>Stem Mixer</h2>
              <div className="space-y-6">
                {Object.entries(stems).map(([stem, { volume, muted }]) => (
                  <div key={stem}>
                    <div className="flex items-center justify-between mb-2">
                      <span className="text-sm font-medium capitalize" style={{ color: muted ? 'var(--text-muted)' : 'var(--text-primary)' }}>{stem}</span>
                      <div className="flex items-center gap-2">
                        <span className="text-xs" style={{ color: 'var(--text-muted)' }}>{volume}%</span>
                        <button onClick={() => toggleStemMute(stem)} className="p-1.5 rounded-lg transition-colors" style={{ background: muted ? 'var(--error-500)' : 'var(--bg-elevated)' }}>
                          {muted ? <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="white" strokeWidth="2"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><line x1="22" y1="9" x2="16" y2="15"/><line x1="16" y1="9" x2="22" y2="15"/></svg> : <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" style={{ color: 'var(--text-muted)' }}><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><path d="M15.54 8.46a5 5 0 0 1 0 7.07"/></svg>}
                        </button>
                      </div>
                    </div>
                    <input type="range" min="0" max="100" value={muted ? 0 : volume} onChange={(e) => handleStemVolume(stem, Number(e.target.value))} disabled={muted} className="w-full h-2 rounded-full cursor-pointer disabled:opacity-50" style={{ background: `linear-gradient(to right, var(--primary-500) ${muted ? 0 : volume}%, var(--bg-elevated) ${muted ? 0 : volume}%)` }} />
                  </div>
                ))}
              </div>
            </div>
          </div>
        </div>
      );
    };

    // ========== PAGE 3: VOICE LAB ==========
    const VoiceLabPage = ({ api, store }) => {
      const toast = useToast();
      const [activeTab, setActiveTab] = useState('clone');
      const [uploadedFile, setUploadedFile] = useState(null);
      const [voiceName, setVoiceName] = useState('');
      const [training, setTraining] = useState(false);
      const [voiceModels, setVoiceModels] = useState([
        { id: 1, name: 'Sarah - Pop', type: 'custom', samples: 12, status: 'ready' },
        { id: 2, name: 'Deep Voice', type: 'custom', samples: 8, status: 'ready' }
      ]);
      const [marketplaceVoices] = useState([
        { id: 101, name: 'Epic Narrator', creator: 'VoiceStudio', rating: 4.9, downloads: '45K', price: 'Free' },
        { id: 102, name: 'Warm Female', creator: 'AudioLab', rating: 4.7, downloads: '32K', price: '$9.99' },
        { id: 103, name: 'Dramatic Male', creator: 'SoundCraft', rating: 4.8, downloads: '28K', price: '$14.99' },
        { id: 104, name: 'Whisper ASMR', creator: 'RelaxAudio', rating: 4.6, downloads: '18K', price: 'Free' }
      ]);
      const tabs = [{ id: 'clone', label: 'Clone Voice' }, { id: 'library', label: 'My Library' }, { id: 'marketplace', label: 'Marketplace' }];

      const handleTrain = async () => {
        if (!uploadedFile || !voiceName.trim()) return;
        setTraining(true);
        await new Promise(r => setTimeout(r, 3000));
        setVoiceModels(prev => [...prev, { id: Date.now(), name: voiceName, type: 'custom', samples: 1, status: 'ready' }]);
        setUploadedFile(null); setVoiceName(''); setTraining(false); setActiveTab('library');
        toast.addToast('Voice model trained successfully!', 'success');
      };

      return (
        <div className="fade-in">
          <div className="mb-8">
            <h1 className="text-2xl font-display font-bold" style={{ color: 'var(--text-primary)' }}>Voice Lab</h1>
            <p className="text-sm mt-1" style={{ color: 'var(--text-secondary)' }}>Clone, manage, and discover voice models</p>
          </div>
          <div className="flex gap-2 mb-6 p-1 rounded-xl w-fit" style={{ background: 'var(--bg-card)' }}>
            {tabs.map(tab => (
              <button key={tab.id} onClick={() => setActiveTab(tab.id)} className="px-4 py-2 rounded-lg text-sm font-medium transition-all"
                style={{ background: activeTab === tab.id ? 'linear-gradient(135deg, var(--primary-500), var(--accent-500))' : 'transparent', color: activeTab === tab.id ? 'white' : 'var(--text-secondary)' }}>
                {tab.label}
              </button>
            ))}
          </div>
          {activeTab === 'clone' && (
            <div className="max-w-2xl rounded-xl p-6" style={{ background: 'var(--bg-card)', border: '1px solid var(--border-subtle)' }}>
              <h2 className="text-lg font-semibold mb-6" style={{ color: 'var(--text-primary)' }}>Clone a Voice</h2>
              <div className="mb-6">
                <label className="block text-sm font-medium mb-2" style={{ color: 'var(--text-secondary)' }}>Voice Name</label>
                <input type="text" value={voiceName} onChange={(e) => setVoiceName(e.target.value)} placeholder="Enter a name for this voice model" className="w-full px-4 py-2.5 rounded-xl text-sm outline-none" style={{ background: 'var(--bg-elevated)', border: '1px solid var(--border-subtle)', color: 'var(--text-primary)' }} />
              </div>
              <div className="mb-6">
                <label className="block text-sm font-medium mb-2" style={{ color: 'var(--text-secondary)' }}>Audio Sample</label>
                <div className="border-2 border-dashed rounded-xl p-8 text-center cursor-pointer transition-all" style={{ borderColor: uploadedFile ? 'var(--success-500)' : 'var(--border-subtle)', background: 'var(--bg-elevated)' }} onClick={() => document.getElementById('voice-upload').click()}>
                  <input id="voice-upload" type="file" accept="audio/*" onChange={(e) => setUploadedFile(e.target.files[0])} className="hidden" />
                  {uploadedFile ? (
                    <div className="flex items-center justify-center gap-3"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" style={{ color: 'var(--success-500)' }}><path d="M20 6 9 17l-5-5"/></svg><span style={{ color: 'var(--text-primary)' }}>{uploadedFile.name}</span></div>
                  ) : (
                    <><svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.5" className="mx-auto mb-4" style={{ color: 'var(--text-muted)' }}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg><p className="text-sm font-medium" style={{ color: 'var(--text-primary)' }}>Click or drag audio file</p><p className="text-xs mt-1" style={{ color: 'var(--text-muted)' }}>MP3, WAV, M4A (min 30s recommended)</p></>
                  )}
                </div>
              </div>
              <button onClick={handleTrain} disabled={!uploadedFile || !voiceName.trim() || training} className="w-full py-3 rounded-xl font-semibold text-white transition-all disabled:opacity-50" style={{ background: 'linear-gradient(135deg, var(--primary-500), var(--accent-500))' }}>
                {training ? <span className="flex items-center justify-center gap-2"><div className="w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin" />Training Voice Model...</span> : 'Train Voice Model'}
              </button>
            </div>
          )}
          {activeTab === 'library' && (
            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
              {voiceModels.map(voice => (
                <div key={voice.id} className="p-5 rounded-xl transition-all hover:scale-[1.02]" style={{ background: 'var(--bg-card)', border: '1px solid var(--border-subtle)' }}>
                  <div className="flex items-start justify-between mb-4">
                    <div className="w-12 h-12 rounded-xl flex items-center justify-center" style={{ background: 'linear-gradient(135deg, var(--primary-500), var(--accent-500))' }}><Icon name="mic" size={24} /></div>
                    <span className="px-2.5 py-1 text-xs font-medium rounded-full" style={{ background: 'rgba(34,197,94,0.15)', color: 'var(--success-500)' }}>{voice.status}</span>
                  </div>
                  <h3 className="font-semibold mb-1" style={{ color: 'var(--text-primary)' }}>{voice.name}</h3>
                  <p className="text-sm mb-4" style={{ color: 'var(--text-muted)' }}>{voice.samples} samples</p>
                  <button onClick={() => toast.addToast(`Using ${voice.name}`, 'info')} className="w-full py-2 rounded-lg text-sm font-medium" style={{ background: 'var(--bg-elevated)', color: 'var(--text-secondary)' }}>Use</button>
                </div>
              ))}
            </div>
          )}
          {activeTab === 'marketplace' && (
            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
              {marketplaceVoices.map(voice => (
                <div key={voice.id} className="p-5 rounded-xl transition-all hover:scale-[1.02]" style={{ background: 'var(--bg-card)', border: '1px solid var(--border-subtle)' }}>
                  <div className="w-full aspect-square rounded-xl mb-4 flex items-center justify-center" style={{ background: 'linear-gradient(135deg, rgba(6,182,212,0.2), rgba(236,72,153,0.2))' }}><Icon name="mic" size={48} /></div>
                  <h3 className="font-semibold mb-1" style={{ color: 'var(--text-primary)' }}>{voice.name}</h3>
                  <p className="text-xs mb-2" style={{ color: 'var(--text-muted)' }}>by {voice.creator}</p>
                  <div className="flex items-center gap-2 mb-4"><span className="text-sm" style={{ color: 'var(--warning-500)' }}>★ {voice.rating}</span><span className="text-xs" style={{ color: 'var(--text-muted)' }}>{voice.downloads}</span></div>
                  <button onClick={() => toast.addToast(`Downloading ${voice.name}...`, 'info')} className="w-full py-2 rounded-lg text-sm font-medium transition-all" style={{ background: voice.price === 'Free' ? 'var(--bg-elevated)' : 'linear-gradient(135deg, var(--primary-500), var(--accent-500))', color: voice.price === 'Free' ? 'var(--text-secondary)' : 'white' }}>{voice.price === 'Free' ? 'Download Free' : voice.price}</button>
                </div>
              ))}
            </div>
          )}
        </div>
      );
    };

    // ========== PAGE 4: VIDEO STUDIO ==========
    const VideoStudioPage = ({ api, store }) => {
      const toast = useToast();
      const [prompt, setPrompt] = useState('');
      const [generating, setGenerating] = useState(false);
      const [captionText, setCaptionText] = useState('');
      const [selectedPlatform, setSelectedPlatform] = useState('youtube');
      const [tracks] = useState([{ id: 1, name: 'Video', clips: [{ id: 'c1', start: 0, duration: 30, color: '#06b6d4' }] }, { id: 2, name: 'Audio', clips: [{ id: 'c2', start: 5, duration: 25, color: '#ec4899' }] }, { id: 3, name: 'Captions', clips: [{ id: 'c3', start: 0, duration: 30, color: '#22c55e' }] }]);
      const platforms = [{ id: 'youtube', name: 'YouTube', aspect: '16:9' }, { id: 'tiktok', name: 'TikTok', aspect: '9:16' }, { id: 'instagram', name: 'Instagram', aspect: '1:1' }, { id: 'twitter', name: 'Twitter', aspect: '16:9' }];

      const handleGenerate = async () => { if (!prompt.trim()) return; setGenerating(true); await new Promise(r => setTimeout(r, 3000)); setGenerating(false); toast.addToast('Video generated!', 'success'); };
      const handleGenerateCaptions = async () => { setCaptionText('Generating...'); await new Promise(r => setTimeout(r, 2000)); setCaptionText('00:00:00 --> 00:00:05\nWelcome to vkTUNEos\n\n00:00:05 --> 00:00:10\nCreated with AI'); toast.addToast('Captions generated!', 'success'); };

      return (
        <div className="fade-in">
          <div className="mb-8"><h1 className="text-2xl font-display font-bold" style={{ color: 'var(--text-primary)' }}>Video Studio</h1><p className="text-sm mt-1" style={{ color: 'var(--text-secondary)' }}>Create, edit, and export AI-powered videos</p></div>
          <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <div className="lg:col-span-2 space-y-6">
              <div className="rounded-xl overflow-hidden" style={{ background: 'black', aspectRatio: '16/9' }}><div className="w-full h-full flex items-center justify-center"><div className="text-center"><div className="w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4" style={{ background: 'rgba(255,255,255,0.1)' }}><Icon name="play" size={32} /></div><p className="text-sm" style={{ color: 'rgba(255,255,255,0.5)' }}>No video loaded</p></div></div></div>
              <div className="rounded-xl p-4" style={{ background: 'var(--bg-card)', border: '1px solid var(--border-subtle)' }}>
                <div className="flex items-center justify-between mb-4"><h3 className="font-semibold" style={{ color: 'var(--text-primary)' }}>Timeline</h3><span className="text-sm" style={{ color: 'var(--text-muted)' }}>00:00 / 00:30</span></div>
                <div className="space-y-2">{tracks.map(t => <div key={t.id} className="flex items-center gap-3"><div className="w-20 text-xs" style={{ color: 'var(--text-secondary)' }}>{t.name}</div><div className="flex-1 h-10 rounded-lg relative" style={{ background: 'var(--bg-elevated)' }}>{t.clips.map(c => <div key={c.id} className="absolute h-8 top-1 rounded" style={{ left: `${(c.start/30)*100}%`, width: `${(c.duration/30)*100}%`, background: c.color }} />)}</div></div>)}</div>
                <div className="mt-4 h-2 rounded-full relative" style={{ background: 'var(--bg-elevated)' }}><div className="absolute h-full rounded-full" style={{ width: '50%', background: 'linear-gradient(90deg, var(--primary-500), var(--accent-500))' }} /></div>
              </div>
            </div>
            <div className="space-y-6">
              <div className="rounded-xl p-6" style={{ background: 'var(--bg-card)', border: '1px solid var(--border-subtle)' }}><h3 className="font-semibold mb-4" style={{ color: 'var(--text-primary)' }}>Generate Video</h3><textarea value={prompt} onChange={(e) => setPrompt(e.target.value)} placeholder="Describe your video..." rows={3} className="w-full px-4 py-3 rounded-xl text-sm outline-none resize-none mb-4" style={{ background: 'var(--bg-elevated)', border: '1px solid var(--border-subtle)', color: 'var(--text-primary)' }} /><button onClick={handleGenerate} disabled={!prompt.trim() || generating} className="w-full py-2.5 rounded-xl font-semibold text-white disabled:opacity-50" style={{ background: 'linear-gradient(135deg, var(--primary-500), var(--accent-500))' }}>{generating ? 'Generating...' : 'Generate Video'}</button></div>
              <div className="rounded-xl p-6" style={{ background: 'var(--bg-card)', border: '1px solid var(--border-subtle)' }}><h3 className="font-semibold mb-4" style={{ color: 'var(--text-primary)' }}>Captions</h3><button onClick={handleGenerateCaptions} className="w-full py-2.5 rounded-xl font-medium mb-4" style={{ background: 'var(--bg-elevated)', color: 'var(--text-secondary)' }}>Auto-Generate Captions</button>{captionText && <textarea value={captionText} onChange={(e) => setCaptionText(e.target.value)} rows={4} className="w-full px-4 py-3 rounded-xl text-xs font-mono outline-none resize-none" style={{ background: 'var(--bg-elevated)', color: 'var(--text-primary)' }} />}</div>
              <div className="rounded-xl p-6" style={{ background: 'var(--bg-card)', border: '1px solid var(--border-subtle)' }}><h3 className="font-semibold mb-4" style={{ color: 'var(--text-primary)' }}>Export</h3><div className="grid grid-cols-2 gap-2 mb-4">{platforms.map(p => <button key={p.id} onClick={() => setSelectedPlatform(p.id)} className="p-3 rounded-lg text-center" style={{ background: selectedPlatform === p.id ? 'linear-gradient(135deg, rgba(6,182,212,0.2), rgba(236,72,153,0.1))' : 'var(--bg-elevated)', border: `1px solid ${selectedPlatform === p.id ? 'var(--primary-500)' : 'transparent'}`, color: selectedPlatform === p.id ? 'var(--primary-400)' : 'var(--text-secondary)' }}><div className="text-sm font-medium">{p.name}</div><div className="text-xs opacity-60">{p.aspect}</div></button>)}</div><button onClick={() => toast.addToast(`Exporting for ${selectedPlatform}...`, 'info')} className="w-full py-2.5 rounded-xl font-semibold text-white" style={{ background: 'linear-gradient(135deg, var(--primary-500), var(--accent-500))' }}>Export Video</button></div>
            </div>
          </div>
        </div>
      );
    };

    // ========== PAGE 5: COORDINATES ==========
    const CoordinatesPage = ({ api, store }) => {
      const toast = useToast();
      const [selectedNode, setSelectedNode] = useState(null);
      const [searchQuery, setSearchQuery] = useState('');
      const [filterCategory, setFilterCategory] = useState('all');
      const [assets] = useState([{ id: 1, name: 'ElevenLabs', category: 'VoiceCloning', domain: 'Model', status: 'Validated', value: 9.2 }, { id: 2, name: 'Phoenix', category: 'StemSeparation', domain: 'Model', status: 'Validated', value: 9.0 }, { id: 3, name: 'Suno', category: 'MusicGeneration', domain: 'Tool', status: 'Proposed', value: 8.5 }, { id: 4, name: 'KitsAI', category: 'VoiceCloning', domain: 'Model', status: 'Draft', value: 8.5 }, { id: 5, name: 'LANDR', category: 'AudioProduction', domain: 'Tool', status: 'Validated', value: 8.0 }, { id: 6, name: 'Udio', category: 'MusicGeneration', domain: 'Tool', status: 'Validated', value: 8.8 }]);
      const treeData = [{ id: 'cat-1', name: 'VoiceCloning', count: 12, children: [{ id: 'dom-1', name: 'Models', count: 8 }, { id: 'dom-2', name: 'Tools', count: 4 }] }, { id: 'cat-2', name: 'MusicGeneration', count: 15, children: [{ id: 'dom-3', name: 'Models', count: 6 }, { id: 'dom-4', name: 'Platforms', count: 9 }] }, { id: 'cat-3', name: 'StemSeparation', count: 5 }, { id: 'cat-4', name: 'AudioProduction', count: 8 }];
      const categories = ['all', 'VoiceCloning', 'MusicGeneration', 'StemSeparation', 'AudioProduction'];
      const filteredAssets = assets.filter(a => a.name.toLowerCase().includes(searchQuery.toLowerCase()) && (filterCategory === 'all' || a.category === filterCategory));
      const getStatusColor = (s) => ({ Validated: { bg: 'rgba(34,197,94,0.15)', text: 'var(--success-500)' }, Proposed: { bg: 'rgba(234,179,8,0.15)', text: 'var(--warning-500)' }, Draft: { bg: 'rgba(160,160,176,0.15)', text: 'var(--text-muted)' } }[s] || { bg: 'rgba(160,160,176,0.15)', text: 'var(--text-muted)' });

      return (
        <div className="fade-in">
          <div className="mb-8"><h1 className="text-2xl font-display font-bold" style={{ color: 'var(--text-primary)' }}>Coordinates</h1><p className="text-sm mt-1" style={{ color: 'var(--text-secondary)' }}>Browse the AI Music Coordinate System</p></div>
          <div className="grid grid-cols-1 lg:grid-cols-4 gap-6">
            <div className="rounded-xl p-4" style={{ background: 'var(--bg-card)', border: '1px solid var(--border-subtle)' }}><h3 className="font-semibold mb-4" style={{ color: 'var(--text-primary)' }}>Categories</h3><TreeView data={treeData} selectedId={selectedNode?.id} onSelect={setSelectedNode} /></div>
            <div className="lg:col-span-3">
              <div className="flex flex-col sm:flex-row gap-4 mb-6">
                <div className="relative flex-1"><Icon name="search" size={18} className="absolute left-3 top-1/2 -translate-y-1/2" style={{ color: 'var(--text-muted)' }} /><input type="text" value={searchQuery} onChange={(e) => setSearchQuery(e.target.value)} placeholder="Search..." className="w-full pl-10 pr-4 py-2.5 rounded-xl text-sm outline-none" style={{ background: 'var(--bg-card)', border: '1px solid var(--border-subtle)', color: 'var(--text-primary)' }} /></div>
                <div className="flex gap-2 overflow-x-auto">{categories.map(cat => <button key={cat} onClick={() => setFilterCategory(cat)} className="px-4 py-2 rounded-xl text-sm font-medium whitespace-nowrap" style={{ background: filterCategory === cat ? 'linear-gradient(135deg, var(--primary-500), var(--accent-500))' : 'var(--bg-card)', color: filterCategory === cat ? 'white' : 'var(--text-secondary)' }}>{cat === 'all' ? 'All' : cat}</button>)}</div>
              </div>
              <div className="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4">
                {filteredAssets.map(asset => (
                  <div key={asset.id} onClick={() => { setSelectedNode(asset); toast.addToast(`Selected ${asset.name}`, 'info'); }} className="p-5 rounded-xl cursor-pointer transition-all hover:scale-[1.02]" style={{ background: 'var(--bg-card)', border: `1px solid ${selectedNode?.id === asset.id ? 'var(--primary-500)' : 'var(--border-subtle)'}` }}>
                    <div className="flex items-start justify-between mb-3"><div className="w-10 h-10 rounded-lg flex items-center justify-center" style={{ background: 'linear-gradient(135deg, rgba(6,182,212,0.2), rgba(236,72,153,0.1))' }}><Icon name="grid" size={20} /></div><span className="px-2.5 py-1 text-xs font-medium rounded-full" style={{ background: getStatusColor(asset.status).bg, color: getStatusColor(asset.status).text }}>{asset.status}</span></div>
                    <h3 className="font-semibold mb-1" style={{ color: 'var(--text-primary)' }}>{asset.name}</h3><p className="text-xs mb-3" style={{ color: 'var(--text-muted)' }}>{asset.category} / {asset.domain}</p>
                    <div className="flex items-center justify-between"><span className="text-xs" style={{ color: 'var(--text-secondary)' }}>Fidelity</span><span className="text-sm font-semibold" style={{ color: 'var(--primary-400)' }}>{asset.value}</span></div>
                  </div>
                ))}
              </div>
            </div>
          </div>
        </div>
      );
    };

    // ========== PAGE 6: WORKFLOWS ==========
    const WorkflowsPage = ({ api, store }) => {
      const toast = useToast();
      const [workflows, setWorkflows] = useState([{ id: 1, name: 'Auto-Master Pipeline', nodes: 5, lastRun: '2 hours ago', status: 'completed' }, { id: 2, name: 'Voice Clone + Convert', nodes: 3, lastRun: '1 day ago', status: 'completed' }, { id: 3, name: 'Stem Separation Flow', nodes: 4, lastRun: 'Never', status: 'draft' }]);
      const [selectedWorkflow, setSelectedWorkflow] = useState(null);
      const [nodes] = useState([{ id: 'n1', type: 'input', label: 'Audio Input', x: 50, y: 80 }, { id: 'n2', type: 'ai', label: 'AI Enhance', x: 220, y: 50 }, { id: 'n3', type: 'process', label: 'Stem Split', x: 220, y: 150 }, { id: 'n4', type: 'process', label: 'Mix & Master', x: 390, y: 100 }, { id: 'n5', type: 'output', label: 'Export', x: 560, y: 100 }]);
      const [connections] = useState([{ from: 'n1', to: 'n2' }, { from: 'n1', to: 'n3' }, { from: 'n2', to: 'n4' }, { from: 'n3', to: 'n4' }, { from: 'n4', to: 'n5' }]);
      const [running, setRunning] = useState(false);
      const nodePalette = [{ type: 'input', label: 'Audio Input', color: 'var(--success-500)' }, { type: 'ai', label: 'AI Process', color: 'var(--warning-500)' }, { type: 'process', label: 'Transform', color: 'var(--primary-500)' }, { type: 'output', label: 'Output', color: 'var(--accent-500)' }];
      const handleRunWorkflow = async () => { setRunning(true); await new Promise(r => setTimeout(r, 3000)); setRunning(false); toast.addToast('Workflow completed!', 'success'); };
      const handleSaveWorkflow = () => toast.addToast('Workflow saved!', 'success');

      return (
        <div className="fade-in">
          <div className="flex items-center justify-between mb-8">
            <div><h1 className="text-2xl font-display font-bold" style={{ color: 'var(--text-primary)' }}>Workflows</h1><p className="text-sm mt-1" style={{ color: 'var(--text-secondary)' }}>Create and manage automation pipelines</p></div>
            <div className="flex gap-3">
              <button onClick={handleSaveWorkflow} className="px-4 py-2 rounded-xl text-sm font-medium" style={{ background: 'var(--bg-card)', color: 'var(--text-secondary)', border: '1px solid var(--border-subtle)' }}>Save</button>
              <button onClick={handleRunWorkflow} disabled={running} className="flex items-center gap-2 px-4 py-2 rounded-xl text-sm font-medium text-white disabled:opacity-50" style={{ background: 'linear-gradient(135deg, var(--primary-500), var(--accent-500))' }}>{running ? <div className="w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin" /> : <Icon name="play" size={16} />}{running ? 'Running...' : 'Run Workflow'}</button>
            </div>
          </div>
          <div className="grid grid-cols-1 lg:grid-cols-5 gap-6">
            <div className="lg:col-span-1 rounded-xl p-4" style={{ background: 'var(--bg-card)', border: '1px solid var(--border-subtle)' }}>
              <h3 className="font-semibold mb-4" style={{ color: 'var(--text-primary)' }}>Nodes</h3>
              <div className="space-y-2">{nodePalette.map(node => <div key={node.type} className="flex items-center gap-3 p-3 rounded-lg cursor-grab" style={{ background: 'var(--bg-elevated)' }}><div className="w-8 h-8 rounded-lg flex items-center justify-center" style={{ background: `${node.color}20` }}><Icon name="plus" size={16} /></div><span className="text-sm" style={{ color: 'var(--text-primary)' }}>{node.label}</span></div>)}</div>
              <h3 className="font-semibold mt-6 mb-4" style={{ color: 'var(--text-primary)' }}>Saved</h3>
              <div className="space-y-2">{workflows.map(wf => <div key={wf.id} onClick={() => { setSelectedWorkflow(wf); toast.addToast(`Loaded ${wf.name}`, 'info'); }} className="p-3 rounded-lg cursor-pointer" style={{ background: selectedWorkflow?.id === wf.id ? 'linear-gradient(135deg, rgba(6,182,212,0.15), rgba(236,72,153,0.1))' : 'var(--bg-elevated)', border: `1px solid ${selectedWorkflow?.id === wf.id ? 'var(--primary-500)' : 'transparent'}` }}><p className="text-sm font-medium" style={{ color: 'var(--text-primary)' }}>{wf.name}</p><p className="text-xs mt-1" style={{ color: 'var(--text-muted)' }}>{wf.nodes} nodes • {wf.lastRun}</p></div>)}</div>
            </div>
            <div className="lg:col-span-4 rounded-xl relative overflow-hidden" style={{ background: 'var(--bg-surface)', border: '1px solid var(--border-subtle)', minHeight: '500px' }}>
              <svg className="absolute inset-0 w-full h-full" style={{ opacity: 0.3 }}><defs><pattern id="wfGrid" width="20" height="20" patternUnits="userSpaceOnUse"><circle cx="1" cy="1" r="1" fill="var(--text-muted)" /></pattern><linearGradient id="connGrad" x1="0%" y1="0%" x2="100%" y2="0%"><stop offset="0%" stopColor="var(--primary-500)" /><stop offset="100%" stopColor="var(--accent-500)" /></linearGradient></defs><rect width="100%" height="100%" fill="url(#wfGrid)" />{connections.map((conn, i) => { const from = nodes.find(n => n.id === conn.from); const to = nodes.find(n => n.id === conn.to); if (!from || !to) return null; const fx = from.x + 100, fy = from.y + 35, tx = to.x, ty = to.y + 35; return <path key={i} d={`M ${fx} ${fy} C ${(fx+tx)/2} ${fy}, ${(fx+tx)/2} ${ty}, ${tx} ${ty}`} fill="none" stroke="url(#connGrad)" strokeWidth="2" />; })}</svg>
              {nodes.map(node => { const palette = nodePalette.find(p => p.type === node.type) || nodePalette[2]; return <div key={node.id} className="absolute rounded-xl p-3 cursor-move" style={{ left: node.x, top: node.y, width: '100px', background: 'var(--bg-card)', border: `2px solid ${palette.color}40` }}><div className="w-8 h-8 rounded-lg flex items-center justify-center mb-2" style={{ background: `${palette.color}20` }}><Icon name="sparkles" size={16} /></div><p className="text-xs font-medium truncate" style={{ color: 'var(--text-primary)' }}>{node.label}</p></div>; })}
            </div>
          </div>
        </div>
      );
    };

    // ========== PAGE 7: TENANTS ==========
    const TenantsPage = ({ api, store }) => {
      const toast = useToast();
      const [tenants, setTenants] = useState([{ id: 1, name: 'Demo Music Studio', slug: 'demo-studio', tier: 'premium', email: 'demo@vktuneos.com', createdAt: '2024-01-15' }, { id: 2, name: 'Indie Records', slug: 'indie-records', tier: 'free', email: 'hello@indierecords.com', createdAt: '2024-02-20' }, { id: 3, name: 'Pro Audio Labs', slug: 'pro-audio', tier: 'enterprise', email: 'admin@proaudio.io', createdAt: '2024-03-10' }]);
      const [showModal, setShowModal] = useState(false);
      const [editingTenant, setEditingTenant] = useState(null);
      const [formData, setFormData] = useState({ name: '', slug: '', tier: 'free', email: '' });
      const tiers = [{ value: 'free', label: 'Free', color: 'var(--text-muted)' }, { value: 'premium', label: 'Premium', color: 'var(--primary-400)' }, { value: 'enterprise', label: 'Enterprise', color: 'var(--warning-500)' }];
      const handleOpenCreate = () => { setEditingTenant(null); setFormData({ name: '', slug: '', tier: 'free', email: '' }); setShowModal(true); };
      const handleOpenEdit = (t) => { setEditingTenant(t); setFormData({ name: t.name, slug: t.slug, tier: t.tier, email: t.email }); setShowModal(true); };
      const handleSave = () => { if (!formData.name.trim()) return; if (editingTenant) { setTenants(prev => prev.map(t => t.id === editingTenant.id ? { ...t, ...formData } : t)); toast.addToast('Tenant updated!', 'success'); } else { setTenants(prev => [...prev, { id: Date.now(), ...formData, createdAt: new Date().toISOString().split('T')[0] }]); toast.addToast('Tenant created!', 'success'); } setShowModal(false); };
      const handleDelete = (id) => { if (confirm('Delete?')) { setTenants(prev => prev.filter(t => t.id !== id)); toast.addToast('Deleted', 'info'); } };
      const getTierBadge = (tier) => { const t = tiers.find(x => x.value === tier) || tiers[0]; return <span className="px-2.5 py-1 text-xs font-medium rounded-full" style={{ background: `${t.color}20`, color: t.color }}>{t.label}</span>; };

      return (
        <div className="fade-in">
          <div className="flex items-center justify-between mb-8"><div><h1 className="text-2xl font-display font-bold" style={{ color: 'var(--text-primary)' }}>Tenants</h1><p className="text-sm mt-1" style={{ color: 'var(--text-secondary)' }}>Manage multi-tenant organizations</p></div><button onClick={handleOpenCreate} className="flex items-center gap-2 px-4 py-2 rounded-xl text-sm font-medium text-white" style={{ background: 'linear-gradient(135deg, var(--primary-500), var(--accent-500))' }}><Icon name="plus" size={16} />Create</button></div>
          <div className="rounded-xl overflow-hidden" style={{ background: 'var(--bg-card)', border: '1px solid var(--border-subtle)' }}>
            <table className="w-full"><thead><tr style={{ background: 'var(--bg-elevated)' }}><th className="px-4 py-3 text-left text-xs font-semibold uppercase" style={{ color: 'var(--text-secondary)' }}>Name</th><th className="px-4 py-3 text-left text-xs font-semibold uppercase" style={{ color: 'var(--text-secondary)' }}>Slug</th><th className="px-4 py-3 text-left text-xs font-semibold uppercase" style={{ color: 'var(--text-secondary)' }}>Tier</th><th className="px-4 py-3 text-left text-xs font-semibold uppercase" style={{ color: 'var(--text-secondary)' }}>Email</th><th className="px-4 py-3 text-right text-xs font-semibold uppercase" style={{ color: 'var(--text-secondary)' }}>Actions</th></tr></thead>
            <tbody>{tenants.map(t => <tr key={t.id} style={{ borderTop: '1px solid var(--border-subtle)' }}><td className="px-4 py-4"><div className="flex items-center gap-3"><div className="w-10 h-10 rounded-lg flex items-center justify-center font-semibold" style={{ background: 'linear-gradient(135deg, var(--primary-500), var(--accent-500))', color: 'white' }}>{t.name[0]}</div><span className="font-medium" style={{ color: 'var(--text-primary)' }}>{t.name}</span></div></td><td className="px-4 py-4 text-sm font-mono" style={{ color: 'var(--text-muted)' }}>{t.slug}</td><td className="px-4 py-4">{getTierBadge(t.tier)}</td><td className="px-4 py-4 text-sm" style={{ color: 'var(--text-secondary)' }}>{t.email}</td><td className="px-4 py-4"><div className="flex justify-end gap-2"><button onClick={() => handleOpenEdit(t)} className="p-2 rounded-lg" style={{ color: 'var(--text-muted)' }}><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg></button><button onClick={() => handleDelete(t.id)} className="p-2 rounded-lg" style={{ color: 'var(--error-500)' }}><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M3 6h18M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/></svg></button></div></td></tr>)}</tbody></table>
          </div>
          {showModal && <div className="fixed inset-0 z-[100] flex items-center justify-center p-4" onClick={() => setShowModal(false)}><div className="absolute inset-0" style={{ background: 'rgba(0,0,0,0.7)' }} /><div className="relative w-full max-w-md rounded-2xl p-6" style={{ background: 'var(--bg-card)', border: '1px solid var(--border-subtle)' }} onClick={(e) => e.stopPropagation()}><h2 className="text-lg font-semibold mb-6" style={{ color: 'var(--text-primary)' }}>{editingTenant ? 'Edit' : 'Create'} Tenant</h2><div className="space-y-4"><div><label className="block text-sm font-medium mb-2" style={{ color: 'var(--text-secondary)' }}>Name</label><input type="text" value={formData.name} onChange={(e) => setFormData({ ...formData, name: e.target.value })} className="w-full px-4 py-2.5 rounded-xl text-sm outline-none" style={{ background: 'var(--bg-elevated)', border: '1px solid var(--border-subtle)', color: 'var(--text-primary)' }} /></div><div><label className="block text-sm font-medium mb-2" style={{ color: 'var(--text-secondary)' }}>Slug</label><input type="text" value={formData.slug} onChange={(e) => setFormData({ ...formData, slug: e.target.value.toLowerCase().replace(/[^a-z0-9-]/g, '-') })} className="w-full px-4 py-2.5 rounded-xl text-sm outline-none font-mono" style={{ background: 'var(--bg-elevated)', border: '1px solid var(--border-subtle)', color: 'var(--text-primary)' }} /></div><div><label className="block text-sm font-medium mb-2" style={{ color: 'var(--text-secondary)' }}>Email</label><input type="email" value={formData.email} onChange={(e) => setFormData({ ...formData, email: e.target.value })} className="w-full px-4 py-2.5 rounded-xl text-sm outline-none" style={{ background: 'var(--bg-elevated)', border: '1px solid var(--border-subtle)', color: 'var(--text-primary)' }} /></div><div><label className="block text-sm font-medium mb-2" style={{ color: 'var(--text-secondary)' }}>Tier</label><select value={formData.tier} onChange={(e) => setFormData({ ...formData, tier: e.target.value })} className="w-full px-4 py-2.5 rounded-xl text-sm outline-none" style={{ background: 'var(--bg-elevated)', border: '1px solid var(--border-subtle)', color: 'var(--text-primary)' }}>{tiers.map(t => <option key={t.value} value={t.value}>{t.label}</option>)}</select></div></div><div className="flex gap-3 mt-6"><button onClick={() => setShowModal(false)} className="flex-1 py-2.5 rounded-xl text-sm font-medium" style={{ background: 'var(--bg-elevated)', color: 'var(--text-secondary)' }}>Cancel</button><button onClick={handleSave} className="flex-1 py-2.5 rounded-xl text-sm font-medium text-white" style={{ background: 'linear-gradient(135deg, var(--primary-500), var(--accent-500))' }}>{editingTenant ? 'Save' : 'Create'}</button></div></div></div>}
        </div>
      );
    };

    // ========== PAGE 8: AUDIT LOG ==========
    const AuditLogPage = ({ api, store }) => {
      const toast = useToast();
      const [events] = useState([{ id: 1, action: 'music.generate', actor: 'demo@vktuneos.com', resource: 'track_001', status: 'success', timestamp: '2024-01-19T10:30:00Z', details: 'Generated 30s track' }, { id: 2, action: 'voice.clone', actor: 'demo@vktuneos.com', resource: 'voice_sarah', status: 'success', timestamp: '2024-01-19T10:15:00Z', details: 'Created voice model' }, { id: 3, action: 'workflow.execute', actor: 'system', resource: 'workflow_001', status: 'success', timestamp: '2024-01-19T09:45:00Z', details: 'Auto-Master Pipeline' }, { id: 4, action: 'api.request', actor: 'api_key_xxx', resource: '/api/v1/music', status: 'error', timestamp: '2024-01-19T08:30:00Z', details: 'Rate limit exceeded' }]);
      const [filterAction, setFilterAction] = useState('all');
      const [filterStatus, setFilterStatus] = useState('all');
      const actions = ['all', 'music.generate', 'voice.clone', 'workflow.execute', 'api.request'];
      const statuses = ['all', 'success', 'error'];
      const filteredEvents = events.filter(e => (filterAction === 'all' || e.action === filterAction) && (filterStatus === 'all' || e.status === filterStatus));
      const handleExport = () => { const csv = 'Action,Actor,Resource,Status,Timestamp,Details\n' + filteredEvents.map(e => `${e.action},${e.actor},${e.resource},${e.status},${e.timestamp},"${e.details}"`).join('\n'); const blob = new Blob([csv], { type: 'text/csv' }); const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = 'audit-log.csv'; a.click(); toast.addToast('Exported!', 'success'); };
      const getStatusBadge = (s) => { const c = { success: { bg: 'rgba(34,197,94,0.15)', text: 'var(--success-500)' }, error: { bg: 'rgba(239,68,68,0.15)', text: 'var(--error-500)' } }[s] || { bg: 'rgba(34,197,94,0.15)', text: 'var(--success-500)' }; return <span className="px-2.5 py-1 text-xs font-medium rounded-full" style={{ background: c.bg, color: c.text }}>{s}</span>; };

      return (
        <div className="fade-in">
          <div className="flex items-center justify-between mb-8"><div><h1 className="text-2xl font-display font-bold" style={{ color: 'var(--text-primary)' }}>Audit Log</h1><p className="text-sm mt-1" style={{ color: 'var(--text-secondary)' }}>Track all system activities</p></div><button onClick={handleExport} className="flex items-center gap-2 px-4 py-2 rounded-xl text-sm font-medium" style={{ background: 'var(--bg-card)', color: 'var(--text-secondary)', border: '1px solid var(--border-subtle)' }}><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>Export</button></div>
          <div className="flex flex-wrap gap-4 mb-6"><select value={filterAction} onChange={(e) => setFilterAction(e.target.value)} className="px-4 py-2 rounded-xl text-sm outline-none" style={{ background: 'var(--bg-card)', border: '1px solid var(--border-subtle)', color: 'var(--text-primary)' }}>{actions.map(a => <option key={a} value={a}>{a === 'all' ? 'All Actions' : a}</option>)}</select><select value={filterStatus} onChange={(e) => setFilterStatus(e.target.value)} className="px-4 py-2 rounded-xl text-sm outline-none" style={{ background: 'var(--bg-card)', border: '1px solid var(--border-subtle)', color: 'var(--text-primary)' }}>{statuses.map(s => <option key={s} value={s}>{s === 'all' ? 'All Statuses' : s}</option>)}</select></div>
          <div className="rounded-xl overflow-hidden" style={{ background: 'var(--bg-card)', border: '1px solid var(--border-subtle)' }}>{filteredEvents.map((e, i) => <div key={e.id} className="flex items-center gap-4 px-4 py-4" style={{ borderTop: i > 0 ? '1px solid var(--border-subtle)' : 'none' }} onMouseOver={(ev) => ev.currentTarget.style.background = 'var(--bg-elevated)'} onMouseOut={(ev) => ev.currentTarget.style.background = 'transparent'}><div className="w-10 h-10 rounded-lg flex items-center justify-center" style={{ background: e.status === 'success' ? 'rgba(34,197,94,0.1)' : 'rgba(239,68,68,0.1)' }}>{e.status === 'success' ? <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="var(--success-500)" strokeWidth="2"><path d="M20 6 9 17l-5-5"/></svg> : <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="var(--error-500)" strokeWidth="2"><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></svg>}</div><div className="flex-1 min-w-0"><div className="flex items-center gap-2 mb-1"><span className="font-mono text-sm" style={{ color: 'var(--primary-400)' }}>{e.action}</span>{getStatusBadge(e.status)}</div><p className="text-sm truncate" style={{ color: 'var(--text-secondary)' }}>{e.details}</p><p className="text-xs mt-1" style={{ color: 'var(--text-muted)' }}>by {e.actor} • {new Date(e.timestamp).toLocaleString()}</p></div><div className="text-right"><p className="text-xs font-mono" style={{ color: 'var(--text-muted)' }}>{e.resource}</p></div></div>)}</div>
          <p className="text-sm mt-4" style={{ color: 'var(--text-muted)' }}>Showing {filteredEvents.length} events</p>
        </div>
      );
    };

    // ========== PAGE 9: KILLER FEATURES ==========
    const KillerFeaturesPage = ({ api, store }) => {
      const toast = useToast();
      const [activeTab, setActiveTab] = useState('collaborator');
      const [chatMessages, setChatMessages] = useState([{ role: 'assistant', content: "Hello! I'm your AI music collaborator. What would you like to create today?" }]);
      const [copyrightFile, setCopyrightFile] = useState(null);
      const [copyrightResult, setCopyrightResult] = useState(null);
      const [scanningCopyright, setScanningCopyright] = useState(false);
      const [moodValue, setMoodValue] = useState({ x: 0.5, y: 0.5 });
      const [contributors] = useState([{ id: 1, name: 'Original Artist', role: 'Composer', share: 40, status: 'confirmed' }, { id: 2, name: 'Feature Artist', role: 'Vocals', share: 25, status: 'confirmed' }, { id: 3, name: 'Producer', role: 'Production', share: 20, status: 'pending' }, { id: 4, name: 'Mix Engineer', role: 'Mixing', share: 15, status: 'confirmed' }]);
      const tabs = [{ id: 'collaborator', label: 'AI Collaborator' }, { id: 'copyright', label: 'Copyright Shield' }, { id: 'mood', label: 'Mood Pad' }, { id: 'rights', label: 'Remix Rights' }];
      const handleSendMessage = (msg) => { setChatMessages(prev => [...prev, { role: 'user', content: msg }, { role: 'assistant', content: `Great idea! Based on "${msg}", I suggest exploring a ${moodValue.x > 0.5 ? 'high-energy' : 'chill'} ${moodValue.y > 0.5 ? 'uplifting' : 'melancholic'} sound.` }]); };
      const handleCopyrightScan = async () => { if (!copyrightFile) return; setScanningCopyright(true); await new Promise(r => setTimeout(r, 2500)); setCopyrightResult({ status: 'clear', confidence: 98.5, matches: [{ source: 'Public Domain', similarity: 12 }, { source: 'CC Pool', similarity: 8 }] }); setScanningCopyright(false); toast.addToast('Scan complete!', 'success'); };
      const handleMoodGenerate = () => { toast.addToast(`Generating ${moodValue.x > 0.5 ? 'energetic' : 'calm'}, ${moodValue.y > 0.5 ? 'happy' : 'melancholic'} track...`, 'info'); };

      return (
        <div className="fade-in">
          <div className="mb-8"><h1 className="text-2xl font-display font-bold" style={{ color: 'var(--text-primary)' }}>Killer Features</h1><p className="text-sm mt-1" style={{ color: 'var(--text-secondary)' }}>Advanced AI-powered music creation tools</p></div>
          <div className="flex gap-2 mb-6 p-1 rounded-xl w-fit overflow-x-auto" style={{ background: 'var(--bg-card)' }}>{tabs.map(tab => <button key={tab.id} onClick={() => setActiveTab(tab.id)} className="px-4 py-2 rounded-lg text-sm font-medium whitespace-nowrap" style={{ background: activeTab === tab.id ? 'linear-gradient(135deg, var(--primary-500), var(--accent-500))' : 'transparent', color: activeTab === tab.id ? 'white' : 'var(--text-secondary)' }}>{tab.label}</button>)}</div>

          {activeTab === 'collaborator' && <div className="grid grid-cols-1 lg:grid-cols-2 gap-6"><div className="rounded-xl overflow-hidden flex flex-col" style={{ background: 'var(--bg-card)', border: '1px solid var(--border-subtle)', height: '500px' }}><div className="p-4" style={{ borderBottom: '1px solid var(--border-subtle)' }}><h3 className="font-semibold" style={{ color: 'var(--text-primary)' }}>AI Music Collaborator</h3></div><div className="flex-1 overflow-y-auto p-4 space-y-4">{chatMessages.map((msg, i) => <div key={i} className={`flex ${msg.role === 'user' ? 'justify-end' : 'justify-start'}`}><div className={`max-w-[80%] px-4 py-3 rounded-2xl ${msg.role === 'user' ? 'rounded-br-sm' : 'rounded-bl-sm'}`} style={{ background: msg.role === 'user' ? 'linear-gradient(135deg, var(--primary-500), var(--accent-500))' : 'var(--bg-elevated)', color: msg.role === 'user' ? 'white' : 'var(--text-primary)' }}><p className="text-sm">{msg.content}</p></div></div>)}</div><div className="p-4 flex gap-3" style={{ borderTop: '1px solid var(--border-subtle)' }}><input type="text" placeholder="Describe what you want to create..." className="flex-1 px-4 py-2.5 rounded-xl text-sm outline-none" style={{ background: 'var(--bg-elevated)', color: 'var(--text-primary)' }} onKeyPress={(e) => { if (e.key === 'Enter' && e.target.value) { handleSendMessage(e.target.value); e.target.value = ''; } }} /><button className="p-2.5 rounded-xl" style={{ background: 'linear-gradient(135deg, var(--primary-500), var(--accent-500))', color: 'white' }}><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg></button></div></div><div className="rounded-xl p-6" style={{ background: 'var(--bg-card)', border: '1px solid var(--border-subtle)' }}><h3 className="font-semibold mb-4" style={{ color: 'var(--text-primary)' }}>Quick Suggestions</h3><div className="grid grid-cols-2 gap-3">{['Generate melody', 'Chord progressions', 'Drum patterns', 'Write lyrics'].map(s => <button key={s} onClick={() => handleSendMessage(s)} className="p-4 rounded-xl text-left" style={{ background: 'var(--bg-elevated)' }}><p className="text-sm font-medium" style={{ color: 'var(--text-primary)' }}>{s}</p></button>)}</div></div></div>}

          {activeTab === 'copyright' && <div className="max-w-2xl rounded-xl p-6" style={{ background: 'var(--bg-card)', border: '1px solid var(--border-subtle)' }}><h3 className="font-semibold mb-4" style={{ color: 'var(--text-primary)' }}>Copyright Shield</h3><p className="text-sm mb-6" style={{ color: 'var(--text-secondary)' }}>Scan audio for copyright issues before publishing.</p><div className="border-2 border-dashed rounded-xl p-8 text-center cursor-pointer mb-6" style={{ borderColor: copyrightFile ? 'var(--success-500)' : 'var(--border-subtle)', background: 'var(--bg-elevated)' }} onClick={() => document.getElementById('copyright-upload').click()}><input id="copyright-upload" type="file" accept="audio/*" onChange={(e) => setCopyrightFile(e.target.files[0])} className="hidden" />{copyrightFile ? <div className="flex items-center justify-center gap-3"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--success-500)" strokeWidth="2"><path d="M20 6 9 17l-5-5"/></svg><span style={{ color: 'var(--text-primary)' }}>{copyrightFile.name}</span></div> : <><svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.5" className="mx-auto mb-4" style={{ color: 'var(--text-muted)' }}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg><p className="text-sm font-medium" style={{ color: 'var(--text-primary)' }}>Upload audio to scan</p></>}</div><button onClick={handleCopyrightScan} disabled={!copyrightFile || scanningCopyright} className="w-full py-3 rounded-xl font-semibold text-white disabled:opacity-50" style={{ background: 'linear-gradient(135deg, var(--primary-500), var(--accent-500))' }}>{scanningCopyright ? 'Scanning...' : 'Scan for Copyright'}</button>{copyrightResult && <div className="mt-6 p-4 rounded-xl" style={{ background: 'rgba(34,197,94,0.1)' }}><div className="flex items-center gap-3 mb-4"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--success-500)" strokeWidth="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg><div><p className="font-semibold" style={{ color: 'var(--success-500)' }}>All Clear!</p><p className="text-sm" style={{ color: 'var(--text-secondary)' }}>{copyrightResult.confidence}% confidence</p></div></div><div className="space-y-2">{copyrightResult.matches.map((m, i) => <div key={i} className="flex justify-between text-sm"><span style={{ color: 'var(--text-secondary)' }}>{m.source}</span><span style={{ color: 'var(--text-muted)' }}>{m.similarity}%</span></div>)}</div></div>}</div>}

          {activeTab === 'mood' && <div className="grid grid-cols-1 lg:grid-cols-2 gap-6"><div className="rounded-xl p-6" style={{ background: 'var(--bg-card)', border: '1px solid var(--border-subtle)' }}><h3 className="font-semibold mb-4" style={{ color: 'var(--text-primary)' }}>Mood Pad</h3><p className="text-sm mb-6" style={{ color: 'var(--text-secondary)' }}>Click anywhere to set mood</p><div className="relative w-full aspect-square rounded-xl overflow-hidden mb-4" style={{ background: 'linear-gradient(135deg, rgba(6,182,212,0.2), rgba(139,92,246,0.2), rgba(236,72,153,0.2))' }} onClick={(e) => { const rect = e.currentTarget.getBoundingClientRect(); setMoodValue({ x: (e.clientX - rect.left) / rect.width, y: 1 - (e.clientY - rect.top) / rect.height }); }}><div className="absolute inset-0" style={{ backgroundImage: 'linear-gradient(rgba(255,255,255,0.05) 1px, transparent 1px), linear-gradient(90deg, rgba(255,255,255,0.05) 1px, transparent 1px)', backgroundSize: '10% 10%' }} /><span className="absolute top-2 right-2 text-xs" style={{ color: 'rgba(255,255,255,0.5)' }}>Happy</span><span className="absolute bottom-2 left-2 text-xs" style={{ color: 'rgba(255,255,255,0.5)' }}>Sad</span><span className="absolute bottom-2 right-2 text-xs" style={{ color: 'rgba(255,255,255,0.5)' }}>Energetic</span><span className="absolute top-2 left-2 text-xs" style={{ color: 'rgba(255,255,255,0.5)' }}>Calm</span><div className="absolute w-6 h-6 rounded-full border-3 border-white shadow-lg" style={{ left: `${moodValue.x * 100}%`, bottom: `${moodValue.y * 100}%`, transform: 'translate(-50%, 50%)', background: 'linear-gradient(135deg, var(--primary-500), var(--accent-500))' }} /></div><div className="flex justify-between text-sm mb-6" style={{ color: 'var(--text-muted)' }}><span>Energy: {(moodValue.x * 100).toFixed(0)}%</span><span>Valence: {(moodValue.y * 100).toFixed(0)}%</span></div><button onClick={handleMoodGenerate} className="w-full py-3 rounded-xl font-semibold text-white" style={{ background: 'linear-gradient(135deg, var(--primary-500), var(--accent-500))' }}>Generate from Mood</button></div><div className="rounded-xl p-6" style={{ background: 'var(--bg-card)', border: '1px solid var(--border-subtle)' }}><h3 className="font-semibold mb-4" style={{ color: 'var(--text-primary)' }}>Mood Analysis</h3><div className="p-4 rounded-xl mb-4" style={{ background: 'var(--bg-elevated)' }}><p className="text-sm font-medium mb-2" style={{ color: 'var(--text-primary)' }}>Current Mood</p><p className="text-2xl font-display font-bold" style={{ background: 'linear-gradient(135deg, var(--primary-400), var(--accent-500))', WebkitBackgroundClip: 'text', WebkitTextFillColor: 'transparent' }}>{moodValue.x > 0.5 && moodValue.y > 0.5 ? 'Euphoric' : moodValue.x > 0.5 && moodValue.y <= 0.5 ? 'Intense' : moodValue.x <= 0.5 && moodValue.y > 0.5 ? 'Peaceful' : 'Melancholic'}</p></div><div className="grid grid-cols-2 gap-3"><div className="p-3 rounded-lg" style={{ background: 'var(--bg-elevated)' }}><p className="text-xs" style={{ color: 'var(--text-muted)' }}>BPM</p><p className="font-semibold" style={{ color: 'var(--text-primary)' }}>{Math.round(80 + moodValue.x * 80)}</p></div><div className="p-3 rounded-lg" style={{ background: 'var(--bg-elevated)' }}><p className="text-xs" style={{ color: 'var(--text-muted)' }}>Key</p><p className="font-semibold" style={{ color: 'var(--text-primary)' }}>{moodValue.y > 0.5 ? 'C Major' : 'A Minor'}</p></div></div></div></div>}

          {activeTab === 'rights' && <div className="rounded-xl overflow-hidden" style={{ background: 'var(--bg-card)', border: '1px solid var(--border-subtle)' }}><div className="p-6" style={{ borderBottom: '1px solid var(--border-subtle)' }}><h3 className="font-semibold" style={{ color: 'var(--text-primary)' }}>Remix Rights Management</h3><p className="text-sm mt-1" style={{ color: 'var(--text-secondary)' }}>Track contributor splits</p></div><table className="w-full"><thead><tr style={{ background: 'var(--bg-elevated)' }}><th className="px-6 py-3 text-left text-xs font-semibold uppercase" style={{ color: 'var(--text-secondary)' }}>Contributor</th><th className="px-6 py-3 text-left text-xs font-semibold uppercase" style={{ color: 'var(--text-secondary)' }}>Role</th><th className="px-6 py-3 text-left text-xs font-semibold uppercase" style={{ color: 'var(--text-secondary)' }}>Share</th><th className="px-6 py-3 text-left text-xs font-semibold uppercase" style={{ color: 'var(--text-secondary)' }}>Status</th></tr></thead><tbody>{contributors.map(c => <tr key={c.id} style={{ borderTop: '1px solid var(--border-subtle)' }}><td className="px-6 py-4"><div className="flex items-center gap-3"><div className="w-8 h-8 rounded-full flex items-center justify-center font-semibold text-sm" style={{ background: 'linear-gradient(135deg, var(--primary-500), var(--accent-500))', color: 'white' }}>{c.name[0]}</div><span className="font-medium" style={{ color: 'var(--text-primary)' }}>{c.name}</span></div></td><td className="px-6 py-4 text-sm" style={{ color: 'var(--text-secondary)' }}>{c.role}</td><td className="px-6 py-4"><div className="flex items-center gap-2"><div className="w-20 h-2 rounded-full" style={{ background: 'var(--bg-elevated)' }}><div className="h-full rounded-full" style={{ width: `${c.share}%`, background: 'linear-gradient(90deg, var(--primary-500), var(--accent-500))' }} /></div><span className="text-sm font-medium" style={{ color: 'var(--primary-400)' }}>{c.share}%</span></div></td><td className="px-6 py-4"><span className="px-2.5 py-1 text-xs font-medium rounded-full" style={{ background: c.status === 'confirmed' ? 'rgba(34,197,94,0.15)' : 'rgba(234,179,8,0.15)', color: c.status === 'confirmed' ? 'var(--success-500)' : 'var(--warning-500)' }}>{c.status}</span></td></tr>)}</tbody></table><div className="p-4 flex justify-between items-center" style={{ borderTop: '1px solid var(--border-subtle)' }}><span className="text-sm" style={{ color: 'var(--text-muted)' }}>Total: 100%</span><button onClick={() => toast.addToast('Add contributor', 'info')} className="px-4 py-2 rounded-xl text-sm font-medium" style={{ background: 'var(--bg-elevated)', color: 'var(--text-secondary)' }}>Add Contributor</button></div></div>}
        </div>
      );
    };

    // ========== MAIN APP ==========
    const App = () => {
      const store = useStore();
      const api = createAPI();
      const renderPage = () => {
        switch (store.page) {
          case 'dashboard': return <DashboardPage api={api} store={store} />;
          case 'music': return <MusicStudioPage api={api} store={store} />;
          case 'voice': return <VoiceLabPage api={api} store={store} />;
          case 'video': return <VideoStudioPage api={api} store={store} />;
          case 'coordinates': return <CoordinatesPage api={api} store={store} />;
          case 'workflows': return <WorkflowsPage api={api} store={store} />;
          case 'tenants': return <TenantsPage api={api} store={store} />;
          case 'audit': return <AuditLogPage api={api} store={store} />;
          case 'killer': return <KillerFeaturesPage api={api} store={store} />;
          default: return <DashboardPage api={api} store={store} />;
        }
      };
      return (
        <ToastProvider>
          <div className="min-h-screen" style={{ background: 'var(--bg-base)' }}>
            <Sidebar store={store} />
            <Header store={store} />
            <main className="pt-16 transition-all duration-300" style={{ marginLeft: store.sidebarOpen ? '256px' : '80px' }}>
              <div className="p-6">{renderPage()}</div>
            </main>
          </div>
        </ToastProvider>
      );
    };

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>